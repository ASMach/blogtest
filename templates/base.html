<!DOCTYPE html>
<html>
<head>
  <link type="text/css" rel="stylesheet" href="/static/main.css" />

  <title>Blog Test</title>

  <!--jQuery is used for some POST methods in this project-->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

  <!--We can toggle elements on certain pages using this script-->
  <script type="text/javascript">
  <!--
    function toggle_visibility(id) {
       var element = document.getElementById(id);
       if(element.style.display == 'block')
          element.style.display = 'none';
       else
          element.style.display = 'block';
    }

  function delete_post(id) {
      // TODO: Delete the selected post
      if (confirm('Delete this post?')) {
        alert('Deleted post');
      } else {
        alert('Post not deleted');
      }
    }

  function like_post(id) {
    // TODO: Add user id to p.liking users
    alert("Liked post!");
  }

  function unlike_post(id) {
    // TODO: Remove user id from p.liking users
    alert("Uniked post!");
  }

  //jQUERY script for when our submit button is clicked
  $(function() {
    $('#submitBtn').click(function() {

      alert("JQuery Running!");

      var post_id = $(this).attr('id')
      var subject = $(this).attr('subject')
      var content = $(this).attr('content')

      $.ajax({
        type: "POST",
        url: "/blog/",
        dataType: 'json',
        data: { "post_id":post_id,"subject":subject,"content":content },
        success: function(data) {
          alert("Post edited successfully");
          window.location(data['redirect_url'])!
        },
        error: function(){
          alert("Failed to edit post!");
        }
      });
    });
  });

  //jQUERY script for when our comment button is clicked
  $(function() {
    $('#commentBtn').click(function() {
      alert("JQuery Running!");

      var body = $(this).attr('body')

      $.ajax({
        type: "POST",
        url: "/blog/",
        contentType: "application/json; charset=utf-8",
        data: { echoValue: $post_id, subject : $subject, content: $content },
        success: function(data) {
          $('#echoResult').text(data.value);
        },
        error: function(){
          alert("Failed to post comment!");
        },
        dataType: "string"
      });
    });
  });
  //-->
</script>
</head>

<body>
  <a href="/blog" class="main-title">
    <h2>
    Blog Test
    </h2>
  </a>

  <div class="login-area">
    {% if user %}
      {{user.name}} (<a class="login-link" href="../blog/logout">logout</a>)
    {% else %}
      <a class="login-link" href="../blog/login">login</a>
      |
      <a class="login-link" href="../blog/signup">signup</a>
    {% endif %}
  </div>
  <hr>

  <div id="content">
  {% block content %}
  {% endblock %}
  </div>

  <hr>
  <footer>
  <h4>
  <a href="../blog/newpost">New Post</a>
  </h4>
  </footer>
</body>

</html>

